<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <!-- Import TensorFlow.js -->
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.0.2/dist/tfjs-vis.umd.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.15.0/d3.min.js"></script>

        <!-- Import the main script file
        <script src="script.js"></script> -->


        <style>
             #map { width: 800px; height: 600px; }
        </style>
    </head>
    <body>
        <div id="container"></div>
                <script>
            //https://www.youtube.com/watch?v=epSgXU3AyiI&t=459s
            async function learnLinear(){

            const model = tf.sequential({
                    
                 layers: [
                   tf.layers.dense({inputShape: [784], units: 32, activation: 'relu'}),
                   tf.layers.dense({units: 10, activation: 'softmax'}),
                 ]
                });

                model.compile({
                  optimizer: 'sgd',
                  loss: 'categoricalCrossentropy',
                  metrics: ['accuracy']
                });

                const data = tf.randomNormal([100, 784]);
                const labels = tf.randomUniform([100, 10]);

                function onBatchEnd(batch, logs) {
                  console.log('Accuracy', logs.acc);
                }

                const surface = { name: 'show.history live', tab: 'Training' };
                // Train for 5 epochs with batch size of 32.
                const history = [];
                await model.fit(data, labels, {
                   epochs: 50,
                   batchSize: 32,
                   callbacks: {
                     onEpochEnd: (epoch, log) => {
                       history.push(log);
                       tfvis.show.history(surface, history, ['loss', 'acc']);
                     }
                   }
                });

        /**
                      data = [];
                      for(let i=0; i<200; i++){
                          data.push([i/5, i/25, i/50, i/30])
                      }

                      console.log(data[27]);
                      console.log(data[34]);
                      console.log(data[99]);

                      const config = {
                          binaryThresh: 0.5,
                          hiddenLayers: [4], // array of ints for the sizes of the hidden layers in the network
                          activation: 'sigmoid', // supported activation types: ['sigmoid', 'relu', 'leaky-relu', 'tanh'],
                          leakyReluAlpha: 0.01, // supported for activation type 'leaky-relu'
                      }


                      dataX = data.map(m => {
                          return [m[0], m[1]]
                      })

                      dataY = data.map(m => {
                          return [m[2], m[3]]
                      })

                      var treino = [];
                      data.forEach((f, i) => {
                          var d = {};
                              d.input  = dataX[i];
                              d.output = dataY[i];  
                          treino.push(d);
                      })

                      const net = new brain.NeuralNetwork(config)
                            net.train(treino);
                            

                      console.log(net.run([5.4, 1.08]));

                      **/

                      

            }

            document.addEventListener('DOMContentLoaded', learnLinear);
        </script>
    </body>
</html>
